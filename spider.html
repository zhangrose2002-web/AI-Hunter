<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ§åˆ¶å° - AI çŒäºº INSIGHT</title>
    <style>
        /* ç»§æ‰¿é¦–é¡µå˜é‡ */
        :root {
            --bg: #020617;
            --text: #f1f5f9;
            --border: #334155;
            --blue: #3b82f6;
            --amber: #f59e0b;
        }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; padding: 2rem; }
        .config-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; max-width: 1200px; margin: 0 auto; }
        .panel { background: rgba(15, 23, 42, 0.5); border: 1px solid var(--border); border-radius: 12px; padding: 20px; }
        h2 { font-size: 1.2rem; color: var(--blue); margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        
        /* å…³é”®è¯æ ‡ç­¾æ ·å¼ */
        .kw-group { margin-bottom: 20px; }
        .kw-title { font-size: 0.8rem; color: #94a3b8; margin-bottom: 10px; }
        .tags-area { display: flex; flex-wrap: wrap; gap: 8px; }
        .kw-tag { background: #1e293b; border: 1px solid var(--border); padding: 4px 10px; border-radius: 4px; font-size: 12px; cursor: pointer; transition: 0.2s; user-select: none; }
        .kw-tag.active { border-color: var(--blue); color: var(--blue); background: rgba(59, 130, 246, 0.1); }
        
        /* æ“ä½œæŒ‰é’® */
        .btn-run { width: 100%; padding: 15px; background: var(--blue); border: none; color: white; font-weight: bold; border-radius: 8px; cursor: pointer; margin-top: 20px; transition: 0.3s; }
        .btn-run:hover { background: #2563eb; box-shadow: 0 0 15px rgba(59,130,246,0.5); }
        .btn-run:disabled { background: #1e293b; color: #64748b; cursor: not-allowed; box-shadow: none; }
        
        input[type="text"] { width: 100%; padding: 12px; background: #0f172a; border: 1px solid var(--border); color: white; border-radius: 6px; margin-top: 10px; outline: none; }
        input[type="text"]:focus { border-color: var(--blue); }
    </style>
</head>
<body>
    <div class="config-grid">
        <div class="panel">
            <h2> ğŸ¯ æ·±åº¦çº¿ç´¢æ¢æµ‹é…ç½®</h2>
            
            <div class="kw-group">
                <div class="kw-title">æ ¸å¿ƒè®¾å¤‡ç›¸å…³ (å°å¸½/å¹³è¡Œç¼ç„Š/æ¿€å…‰å°ç„Š)</div>
                <div class="tags-area" id="device-tags">
                    <span class="kw-tag active">æ°”å¯†æ€§å°è£…è®¾å¤‡</span>
                    <span class="kw-tag active">çœŸç©ºå¹³è¡Œç¼ç„Šæœº</span>
                    <span class="kw-tag active">æ¿€å…‰å°ç„Šå·¥è‰º</span>
                    <span class="kw-tag">é‡‘å±ç®¡å£³å°è£…</span>
                </div>
            </div>

            <div class="kw-group">
                <div class="kw-title">çƒ­é—¨èµ›é“ (800G/è½¦è§„çº§/åŠŸç‡å™¨ä»¶)</div>
                <div class="tags-area" id="sector-tags">
                    <span class="kw-tag">800Gå…‰æ¨¡å—</span>
                    <span class="kw-tag">IGBTæ¨¡å—</span>
                    <span class="kw-tag">SiCåŠŸç‡å™¨ä»¶</span>
                    <span class="kw-tag">MEMSä¼ æ„Ÿå™¨</span>
                    <span class="kw-tag">CPOæŠ€æœ¯</span>
                </div>
            </div>

            <div class="kw-group">
                <div class="kw-title">æ‰©äº§ä¿¡å· (æ‹›æ ‡/å¢äº§/æ‰“æ ·)</div>
                <div class="tags-area" id="signal-tags">
                    <span class="kw-tag">äº§çº¿æ‰©èƒ½</span>
                    <span class="kw-tag">æ–°å¢äº§çº¿æ‹›æ ‡</span>
                    <span class="kw-tag">å°æ‰¹é‡è¯•äº§</span>
                    <span class="kw-tag">äº§èƒ½ç¿»å€</span>
                    <span class="kw-tag">å›½äº§åŒ–æ›¿ä»£</span>
                </div>
            </div>

            <div class="kw-title">è‡ªå®šä¹‰ç»„åˆæœç´¢ (JSON æ ¼å¼)</div>
            <input type="text" id="custom-query" placeholder='ä¾‹å¦‚: "äº§èƒ½ç¿»å€" + "TO-CANå°è£…"'>
        </div>

        <div class="panel">
            <h2> ğŸš€ çˆ¬è™«å¼•æ“å‚æ•°</h2>
            <div style="margin-bottom: 15px;">
                <label style="font-size: 12px; color: #94a3b8;">æ¢æµ‹æ·±åº¦</label>
                <select id="spider-depth" style="width:100%; padding:10px; background:#0f172a; color:white; border:1px solid var(--border); border-radius: 6px;">
                    <option value="fast">å…¨ç½‘å®æ—¶æƒ…æŠ¥ (å¿«é€Ÿ)</option>
                    <option value="deep">æ·±åº¦è¡Œä¸šæŠ¥å‘Š (æ…¢é€Ÿ)</option>
                    <option value="monitor">æ‹›æ ‡/å…¬å‘Šå®šå‘ç›‘æ§</option>
                </select>
            </div>
            <div style="margin-bottom: 15px;">
                <label style="font-size: 12px; color: #94a3b8;">é‡‡é›†èŠ‚ç‚¹</label>
                <div style="font-size: 12px; margin-top:5px;">
                    <input type="checkbox" checked disabled> GitHub US-East (å›½å¤–) <br>
                    <input type="checkbox" checked disabled> Proxy-Node CN (å›½å†…)
                </div>
            </div>
            <button class="btn-run" id="run-btn" onclick="triggerSpider()">å¯åŠ¨å…¨çƒçº¿ç´¢é‡‡é›†</button>
            <div id="status-msg" style="margin-top:15px; font-size:12px; color:var(--amber); text-align:center; line-height: 1.6;"></div>
        </div>
    </div>

    <script>
        // 1. å¤„ç†æ ‡ç­¾ç‚¹å‡»ï¼ˆä¿æŒåŸæœ‰äº¤äº’ï¼‰
        document.querySelectorAll('.kw-tag').forEach(tag => {
            tag.onclick = () => tag.classList.toggle('active');
        });

        // 2. æ ¸å¿ƒè§¦å‘å‡½æ•°
        async function triggerSpider() {
            const btn = document.getElementById('run-btn');
            const msg = document.getElementById('status-msg');
            
            // --- é…ç½®åŒº ---
            // è¯·åœ¨æ­¤å¤„å¡«å…¥ä½ çš„çœŸå®ä¿¡æ¯
            const GITHUB_TOKEN = "ä½ çš„_GITHUB_PERSONAL_ACCESS_TOKEN"; 
            const REPO_OWNER = "zhangrose2002-web";
            const REPO_NAME = "AI-Hunter";
            // --------------

            // è·å–å½“å‰é€‰ä¸­çš„æ‰€æœ‰å…³é”®è¯
            const selectedKeywords = Array.from(document.querySelectorAll('.kw-tag.active')).map(t => t.innerText);
            const customQuery = document.getElementById('custom-query').value;
            const depth = document.getElementById('spider-depth').value;

            // çŠ¶æ€æ›´æ–°
            btn.disabled = true;
            msg.style.color = "var(--amber)";
            msg.innerHTML = "ğŸ“¡ æ­£åœ¨åŠ å¯†å‘é€æŒ‡ä»¤è‡³ GitHub Actions...<br>è¯·å‹¿å…³é—­é¡µé¢";

            try {
                // è°ƒç”¨ GitHub API çš„ repository_dispatch æ¥å£
                const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/dispatches`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        event_type: 'run_spider', // å¿…é¡»ä¸ .yml æ–‡ä»¶ä¸­çš„ types å¯¹åº”
                        client_payload: {
                            keywords: selectedKeywords,
                            custom_query: customQuery,
                            depth: depth
                        }
                    })
                });

                if (response.status === 204) { // GitHub æˆåŠŸæ¥æ”¶ Dispatch çš„çŠ¶æ€ç æ˜¯ 204
                    msg.style.color = "#10b981"; // æˆåŠŸç»¿
                    msg.innerHTML = "âœ… ä»»åŠ¡å·²æˆåŠŸæ’é˜Ÿï¼<br>äº‘ç«¯çˆ¬è™«å·²å¯åŠ¨ï¼Œé¢„è®¡ 2 åˆ†é’Ÿåæ•°æ®åŒæ­¥è‡³é¦–é¡µã€‚";
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.message || "æƒé™éªŒè¯å¤±è´¥");
                }
            } catch (e) {
                console.error(e);
                msg.style.color = "#ef4444"; // é”™è¯¯çº¢
                msg.innerHTML = `âŒ è§¦å‘å¤±è´¥<br>åŸå› ï¼š${e.message}<br>è¯·æ£€æŸ¥ Token æƒé™æˆ–ä»“åº“åç§°ã€‚`;
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
